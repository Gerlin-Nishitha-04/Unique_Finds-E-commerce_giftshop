<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNIQUE FINDS - Checkout</title>
    <style>
        /* General Styles */
        body {
            margin: 0;
            font-family: 'Arial', sans-serif;
            background-color: white;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background-color: #560835;
            color: white;
            padding: 20px 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .account-links a {
            text-decoration: none;
            color: white;
            margin: 0 10px;
            font-weight: bold;
        }

        .account-links a:hover {
            text-decoration: underline;
        }

        .logo a {
            text-decoration: none;
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        main {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            /* Centering vertically */
            padding: 20px;
        }

        .checkout-page {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            padding: 20px;

            /* Padding around the entire page */
        }

        .checkout-container {
            max-width: 600px;
            /* You can adjust this as needed */
            width: 100%;
            padding: 0 20px;
            /* Add padding to ensure left and right spacing */
        }

        form {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 600px;
            /* Set a maximum width for the form */
        }

        section {
            background-color: #f9f9f9;
            padding: 70px;
            /* Reduced padding to create a better fit */
            border-radius: 8px;
            border: 2px solid #ccc;
            /* Increased border width */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 10px auto;
            /* Center align section */
        }
        h1{
            font-size:40px;
            color:#560835;
            text-align: center;
        }

        h2 {
            margin: 0 0 15px 0;
            color: #560835;
            text-align: center;
            font-size: 30px;
            /* Center aligned Checkout heading */
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        input[type="text"],
        input[type="tel"] {
            width: 100%;
            padding: 15px;
            /* Adjusted padding for inputs */
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        /* Button styles */
        .place-order-button {
            background-color: darkgoldenrod;
            color: white;
            border: none;
            padding: 12px;
            /* Adjusted padding for the button */
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            border-radius: 4px;
            transition: background-color 0.3s;
            /* Smooth transition */
        }

        .place-order-button:hover {
            background-color: #e6b800;
        }

        footer {
            background-color: #560835;
            color: white;
            text-align: center;
            padding: 20px 0;
            width: 100%;
        }

        /* Order Summary section */
        .order-summary {
            background-color: #fff;
        }

        .order-summary p {
            margin: 10px 0;
        }

        .order-item {
            margin-bottom: 10px;
        }

        #order-total {
            font-weight: bold;
            font-size: 18px;
        }
        html, body {
        height: 100%;
        margin: 0;
        font-family: Arial, sans-serif;
    }
    
    /* Apply the background image to the entire page */
    body {
        background-image: url('../images/bag.jpg'); /* Replace 'your-image.jpg' with the path to your image */
        background-size: cover;  /* This makes the image cover the whole page */
        background-position: center; /* Center the image */
        background-repeat: no-repeat; /* Prevent the image from repeating */
        background-attachment: fixed; /* Keep the background fixed while scrolling */
    }
    </style>
</head>

<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <a href="index.html">UNIQUE FINDS</a>
            </div>
            <div class="account-links">
                <a href="index.html" id="home-link">Home</a>
                <a href="cart.html" id="cart-link">Cart</a>
                <a href="contact.html" id="contact">Contact</a>
            </div>
        </div>
    </header>

    <main class="checkout-page">
        <div class="checkout-container">
            <h1>Checkout</h1>

            <form id="checkout-form" onsubmit="return validateAndPlaceOrder()">
                <!-- Shipping Information Section -->
                <section class="shipping-info">
                    <h2>Shipping Information</h2>
                    <label for="fullname">Full Name:</label>
                    <input type="text" id="fullname" name="fullname" required>

                    <label for="address">Address:</label>
                    <input type="text" id="address" name="address" required>

                    <label for="city">City:</label>
                    <input type="text" id="city" name="city" required>

                    <label for="state">State:</label>
                    <input type="text" id="state" name="state" required>

                    <label for="zip">ZIP Code:</label>
                    <input type="text" id="zip" name="zip" required maxlength="6" pattern="[0-9]{6}" inputmode="numeric"
                        title="Please enter exactly 6 digits">

                    <label for="phone">Phone Number:</label>
                    <input type="tel" id="phone" name="phone" required maxlength="10" pattern="[0-9]{10}"
                        inputmode="numeric" title="Please enter exactly 10 digits">
                </section>

                <!-- Payment Information Section -->
                <section class="payment-info">
                    <h2>Payment Information</h2>
                    <label for="cardname">Name on Card:</label>
                    <input type="text" id="cardname" name="cardname" required>

                    <label for="cardnumber">Card Number:</label>
                    <input type="text" id="cardnumber" name="cardnumber" required maxlength="16" pattern="[0-9]{16}"
                        inputmode="numeric" title="Please enter exactly 16 digits">

                    <label for="expmonth">Expiration Month:</label>
                    <input type="text" id="expmonth" name="expmonth" required maxlength="2" pattern="[0-9]{2}"
                        placeholder="MM" title="Month must be between 01 and 12">

                    <label for="expyear">Expiration Year:</label>
                    <input type="text" id="expyear" name="expyear" required maxlength="4" pattern="[0-9]{4}"
                        inputmode="numeric" placeholder="YYYY">

                    <label for="cvv">CVV:</label>
                    <input type="text" id="cvv" name="cvv" required pattern="\d{3}" maxlength="3" inputmode="numeric"
                        title="Please enter exactly 3 digits">
                </section>

                <!-- Order Summary Section -->
                <section class="order-summary">
                    <h2>Order Summary</h2>
                    <table style="border-collapse: collapse; width: 100%; border: 1px solid black; text-align: center;">
                        <tr>
                            <th style="border: 1px solid black; padding: 8px;">Product</th>
                            <th style="border: 1px solid black; padding: 8px;">Price (₹)</th>
                            <th style="border: 1px solid black; padding: 8px;">Quantity</th>
                            <th style="border: 1px solid black; padding: 8px;">Total Price (₹)</th>
                        </tr>
                        <tbody id="orderitems">
                            <!-- Dynamically generated order items will appear here -->
                        </tbody>
                    </table>
                    <p id="ordertotal">Total: ₹0.00</p>
                    <input type="hidden" id="cart" name="cart">
                    <!-- Place Order Button -->
                    <button type="submit" class="place-order-button">Submit</button>
                </section>
            </form>
        </div>
    </main>

    <footer>
        <p>&copy; 2024 UNIQUE FINDS. All rights reserved.</p>
    </footer>

    <script>
        // Load the cart items from localStorage and display them in the Order Summary section
        document.addEventListener('DOMContentLoaded', function () {
            loadOrderSummary();
        });
    
        function loadOrderSummary() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const orderItemsContainer = document.getElementById('orderitems');
            const orderTotalElement = document.getElementById('ordertotal');
            let totalPrice = 0;
    
            orderItemsContainer.innerHTML = ''; // Clear current order summary
    
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                totalPrice += itemTotal;
    
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>₹${item.price}</td>
                    <td>${item.quantity}</td>
                    <td>₹${itemTotal.toFixed(2)}</td>
                `;
    
                orderItemsContainer.appendChild(row);
            });
    
            orderTotalElement.innerText = `Total: ₹${totalPrice.toFixed(2)}`;
        }
    
        function validateAndPlaceOrder() {
            // Get user input
            const fullname = document.getElementById('fullname').value;
            const address = document.getElementById('address').value;
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const orderTotal = document.getElementById('ordertotal').innerText;
    
            // Check for required fields
            if (!fullname || !address || cart.length === 0) {
                alert('Please fill in all required fields and ensure your cart is not empty.');
                return false; // Prevent form submission
            }
    
            // Store the cart data in the hidden input before submitting
            document.getElementById('cart').value = JSON.stringify(cart);
            // Show a confirmation alert
            alert('Order placed successfully!');
    
            // Redirect to the thanks page
            window.location.href = 'thanks.html'; // Redirect to thanks page
    
            return false; // Prevent default form submission
        }
    
    </script>
    
    <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-app-compat.js"></script>
    
    <!-- Firebase Realtime Database -->
    <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-database-compat.js"></script>
    
    <script>
        // Initialize Firebase with the correct configuration
        const firebaseConfig = {
            databaseURL: "https://uniquefindsorders-default-rtdb.asia-southeast1.firebasedatabase.app"
        };
        firebase.initializeApp(firebaseConfig);
    
        // Initialize the Realtime Database reference
        const database = firebase.database();
    
        // Run the function on the "Submit Order" button click
        const submit = document.querySelector('button');
        submit.onclick = (event) => {
            // Prevent form submission if validation fails
            event.preventDefault();
            sendData();
        };
    
        // Function to validate inputs and send data to Firebase
        function sendData() {
            var fullname = document.querySelectorAll('input')[0].value;
            var address = document.querySelectorAll('input')[1].value;
            var city = document.querySelectorAll('input')[2].value;
            var state = document.querySelectorAll('input')[3].value;
            var zip = document.querySelectorAll('input')[4].value;
            var phone = document.querySelectorAll('input')[5].value;
    
            // Validate that all fields are filled
            if (!fullname || !address || !city || !state || !zip || !phone) {
                alert("Please fill in all fields before submitting.");
                return;
            }
    
            // Collect the order summary data
            var orderItems = [];
            var orderItemsTable = document.getElementById('orderitems').children;
    
            for (var i = 0; i < orderItemsTable.length; i++) {
                var row = orderItemsTable[i];
                var product = row.children[0].innerText;
                var price = row.children[1].innerText;
                var quantity = row.children[2].innerText;
                var totalPrice = row.children[3].innerText;
    
                // Add the data to the orderItems array
                orderItems.push({
                    product: product,
                    price: price,
                    quantity: quantity,
                    totalPrice: totalPrice
                });
            }
    
            // Collect the total order amount
            var orderTotal = document.getElementById('ordertotal').innerText.replace('Total: ₹', '');
    
            // Create the orderData object
            var orderData = {
                fullname: fullname,
                address: address,
                city: city,
                state: state,
                zip: zip,
                phone: phone,
                orderItems: orderItems, // Array of ordered items
                orderTotal: orderTotal  // Total price of the order
            };
    
            // Push the data to Firebase Realtime Database
            database.ref('orders').push(orderData)
                .then(() => {
                    console.log('Order saved successfully!');
                    alert("Order saved successfully!");
    
                    // Redirect to the thanks page after successful order submission
                    window.location.href = 'thanks.html';
                })
                .catch((error) => {
                    console.error('Error saving order:', error);
                    alert("Failed to save order. Please try again.");
                });
        }
    </script>
    


</body>

</html>